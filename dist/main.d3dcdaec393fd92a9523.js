!function(e){function t(t){for(var n,o,i=t[0],c=t[1],u=t[2],p=0,d=[];p<i.length;p++)o=i[p],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&d.push(a[o][0]),a[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(l&&l(t);d.length;)d.shift()();return s.push.apply(s,u||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],n=!0,i=1;i<r.length;i++){var c=r[i];0!==a[c]&&(n=!1)}n&&(s.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},a={0:0},s=[];function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=c;s.push([117,1]),r()}({102:function(e,t,r){var n=r(103);"string"==typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r(40)(n,a);n.locals&&(e.exports=n.locals)},103:function(e,t,r){(e.exports=r(39)(!1)).push([e.i,".list-page {\n  max-width: 800px;\n  margin: auto;\n}\n.list-item-container {\n  position: relative;\n}\n.list-item-container__progress-indicator {\n  position: absolute !important;\n  top: 0;\n  left: 0;\n  right: 0;\n}\n",""])},105:function(e,t,r){var n=r(106);"string"==typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r(40)(n,a);n.locals&&(e.exports=n.locals)},106:function(e,t,r){(e.exports=r(39)(!1)).push([e.i,".state-display {\n  display: flex;\n}\n.state-display__chip-8-state {\n  margin-left: 35px;\n}\n",""])},107:function(e,t,r){var n=r(108);"string"==typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r(40)(n,a);n.locals&&(e.exports=n.locals)},108:function(e,t,r){(e.exports=r(39)(!1)).push([e.i,".assembly {\n  min-width: 193px;\n}\n.assembly__line--current {\n  background-color: cornflowerblue;\n}\n.assembly__opcode {\n  text-align: end;\n}\n",""])},109:function(e,t,r){var n=r(110);"string"==typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r(40)(n,a);n.locals&&(e.exports=n.locals)},110:function(e,t,r){(e.exports=r(39)(!1)).push([e.i,".keyboard {\n  display: inline-block;\n  background: #bbb;\n  background-image: -webkit-gradient(linear, left bottom, left top, color-stop(0.27, #d4d8db), color-stop(0.64, #d5d9dc), color-stop(0.95, #e6e9eb), color-stop(1, #bfbfbf));\n  background-image: -moz-linear-gradient(center bottom, #d4d8db 27%, #d5d9dc 64%, #e6e9eb 95%, #bfbfbf 100%);\n  -moz-border-radius-topleft: 7px 21px;\n  -moz-border-radius-topright: 7px 21px;\n  -moz-border-radius-bottomright: 10px;\n  -moz-border-radius-bottomleft: 10px;\n  border-top-left-radius: 7px 21px;\n  border-top-right-radius: 7px 21px;\n  border-bottom-right-radius: 10px;\n  border-bottom-left-radius: 10px;\n  padding: 50px 0 10px 0;\n  -webkit-box-shadow: inset 0 0 8px #bbb, 0 1px 0 #aaa, 0 4px 0 #bbb, 0 10px 30px #ddd;\n  -moz-box-shadow: inset 0 0 8px #bbb, 0 1px 0 #aaa, 0 4px 0 #bbb, 0 10px 30px #ddd;\n  box-shadow: inset 0 0 8px #bbb, 0 1px 0 #aaa, 0 4px 0 #bbb, 0 10px 30px #ddd;\n}\n.keyboard__row {\n  display: flex;\n  list-style-type: none;\n  padding: 0;\n  margin: 0;\n}\n.keyboard__key {\n  color: #aaa;\n  font: bold 9pt arial;\n  text-decoration: none;\n  text-align: center;\n  width: 44px;\n  height: 41px;\n  margin: 5px;\n  background: #eff0f2;\n  border-radius: 4px;\n  border-top: 1px solid #f5f5f5;\n  box-shadow: inset 0 0 25px #e8e8e8, 0 1px 0 #c3c3c3, 0 2px 0 #c9c9c9, 0 2px 3px #333;\n  text-shadow: 0px 1px 0px #f5f5f5;\n  filter: dropshadow(color=#f5f5f5, offx=0, offy=1);\n}\n.keyboard__key:active,\n.keyboard__key--press {\n  color: #888;\n  background: #ebeced;\n  margin: 7px 5px 3px;\n  box-shadow: inset 0 0 25px #ddd, 0 0 3px #333;\n  border-top: 1px solid #eee;\n}\n.keyboard__key .key__label {\n  display: block;\n  margin: 13px 0 0;\n  text-transform: uppercase;\n}\n",""])},111:function(e,t,r){var n=r(112);"string"==typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r(40)(n,a);n.locals&&(e.exports=n.locals)},112:function(e,t,r){(e.exports=r(39)(!1)).push([e.i,".chip-8 {\n  padding: 8px;\n}\n.chip-8__display {\n  display: flex;\n  justify-content: center;\n  margin-bottom: 8px;\n}\n.chip-8__debug-info {\n  display: flex;\n  justify-content: center;\n}\n.debug-info__state-display {\n  display: flex;\n  min-width: 605px;\n  align-items: center;\n  justify-content: center;\n  font-family: monospace;\n}\n.state-display__display {\n  margin-right: 24px;\n}\n",""])},113:function(e,t,r){var n=r(114);"string"==typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r(40)(n,a);n.locals&&(e.exports=n.locals)},114:function(e,t,r){(e.exports=r(39)(!1)).push([e.i,".menu-settings {\n  padding: 15px;\n}\n",""])},115:function(e,t,r){var n=r(116);"string"==typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r(40)(n,a);n.locals&&(e.exports=n.locals)},116:function(e,t,r){(e.exports=r(39)(!1)).push([e.i,".game__loader {\n  display: flex;\n  justify-content: center;\n}\n",""])},117:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),s=r(9),o=r.n(s),i=r(73),c=r(35),u=r(8),l=r(2),p=r.n(l),d=r(155),m=r(156),y=r(154),f=r(118),b=r(150),h=r(151),E=r(152),g=r(75),_=r.n(g);const R=({name:e,disabled:t,onStart:r})=>a.a.createElement(f.a,null,a.a.createElement(b.a,null,e),a.a.createElement(h.a,null,a.a.createElement(E.a,{edge:"end",disabled:t,onClick:r},a.a.createElement(_.a,null))));R.propTypes={name:p.a.string.isRequired,onStart:p.a.func.isRequired,disabled:p.a.bool.isRequired};var S=R;const v="[Roms] SET_NEW_ROM",k="[Roms] SET_NEW_ROM_INDEX";const T=e=>e.romsReducer,x=e=>T(e).roms,w=e=>T(e).selectedRomIndex;var D=r(153);const O={name:null,progress:-1,loading:!1},N="SET_LOADING",P="SET_PROGRESS",C="SET_NAME";function I(e){const[t,r]=Object(n.useReducer)(A,O),a=Object(n.useRef)({unsubscribe:j}),s=Object(n.useRef)({unsubscribe:j}),o=Object(u.c)();return Object(n.useEffect)(()=>()=>{a.current.unsubscribe(),s.current.unsubscribe()},[]),[t,function(){const t=e.current.files;if(t.length){const e=new FileReader,i=t[0];a.current=Object(D.a)(e,"load").subscribe(e=>{const t=e.target.result;r(U(!1)),o(function(e,t){return{type:v,payload:{name:e,rom:t}}}(i.name,new Uint8Array(t))),a.current.unsubscribe(),s.current.unsubscribe()}),s.current=Object(D.a)(e,"progress").subscribe(e=>{const{loaded:t,total:n}=e;r(L(t/n*100|0))}),e.readAsArrayBuffer(i),r((n=i.name,{type:C,payload:{name:n}})),r(L(0)),r(U(!0))}var n}]}function A(e,t){switch(t.type){case N:return{...e,loading:t.payload.loading};case P:return{...e,progress:t.payload.progress};case C:return{...e,name:t.payload.name}}}function U(e){return{type:N,payload:{loading:e}}}function L(e){return{type:P,payload:{progress:e}}}function j(){}r(102);const B={root:"list-item-container__progress-indicator"},M=({goToGameState:e})=>{const t=Object(u.d)(x),r=Object(n.useRef)(),[s,o]=I(r),{loading:i}=s,c=Object(u.c)();function l(t){return function(){c({type:k,payload:{index:t}}),e()}}const p=t.map(({name:e},t)=>a.a.createElement("div",{key:t,className:"list-item-container"},a.a.createElement(S,{name:e,disabled:i,onStart:l(t)})));if(i){const{progress:e,name:t}=s;p.push(a.a.createElement("div",{key:-1,className:"list-item-container"},a.a.createElement(y.a,{classes:B,variant:"determinate",value:e}),a.a.createElement(S,{name:t,disabled:i,onStart:l(-1)})))}return a.a.createElement("div",{className:"list-page"},a.a.createElement(d.a,null,p),a.a.createElement("input",{id:"contained-button-file",type:"file",ref:r,style:{display:"none"},onChange:o,disabled:i}),a.a.createElement("label",{htmlFor:"contained-button-file"},a.a.createElement(m.a,{variant:"contained",component:"span",disabled:i},"Upload")))};M.propTypes={goToGameState:p.a.func.isRequired};var $=M,K=r(163),q=r(162);function F(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class G extends a.a.Component{constructor(...e){super(...e),F(this,"canvasRef",a.a.createRef()),F(this,"ctx",null)}componentDidMount(){this.ctx=this.canvasRef.current.getContext("2d"),this.setImageBinaries(this.props.imageData)}componentWillReceiveProps(e){this.setImageBinaries(e.imageData)}shouldComponentUpdate(e){return this.props.width!==e.width||this.props.height!==e.height}setImageBinaries(e){e&&this.ctx.putImageData(e,0,0)}render(){const{width:e,height:t,onKeyDown:r,onKeyUp:n,onBlur:s}=this.props;return a.a.createElement("canvas",{ref:this.canvasRef,tabIndex:0,width:e,height:t,onKeyDown:r,onKeyUp:n,onBlur:s},null)}}G.propTypes={width:p.a.number,height:p.a.number,imageData:p.a.object,onKeyDown:p.a.func,onKeyUp:p.a.func,onBlur:p.a.func},G.defaultProps={width:300,height:150};const W=64,X=32,V=new Uint8Array([240,144,144,144,240,32,96,32,32,112,240,16,240,128,240,240,16,240,16,240,144,144,240,16,16,240,128,240,16,240,240,128,240,144,240,240,16,32,64,64,240,144,240,144,240,240,144,240,16,240,240,144,240,144,144,224,144,224,144,224,240,128,128,128,240,224,144,144,144,224,240,128,240,128,240,240,128,240,128,128]);function Y(e,t,r,n){const a=255*n;let s=4*t+4*e.width*r;e.data[s++]=a,e.data[s++]=a,e.data[s++]=a,e.data[s++]=255}function H(){const e=new SharedArrayBuffer(W*X);return{buffer:new Uint8Array(e)}}function z(e,t,r){return e.buffer[W*r+t]}function J(e,t,r){for(let n=0;n<X*r;n++)for(let a=0;a<W*r;a++)Y(e,a,n,z(t,a/r|0,n/r|0));return e}function Q(e){return{width:W*e,height:X*e}}function Z(e){return e.buffer}class ee extends a.a.Component{constructor(e){super(e);const{width:t,height:r}=Q(e.scale);this.canvasRef=a.a.createRef(),this.imageData=new ImageData(t,r)}componentDidMount(){const{display:e}=this.props;J(this.imageData,e,this.props.scale),this.setImageData(e)}componentDidUpdate(e){const{scale:t}=this.props;if(e.scale!==t){const{width:e,height:r}=Q(t),{display:n}=this.props;this.imageData=new ImageData(e,r),J(this.imageData,n,t),this.setImageData(n)}}shouldComponentUpdate(e){return this.props.scale!==e.scale}updateDisplayData(e){J(this.imageData,e,this.props.scale),this.setImageData(this.props.display)}setImageData(e){this.canvasRef.current.setImageBinaries(this.imageData)}render(){const{onKeyDown:e,onKeyUp:t,onBlur:r}=this.props,{width:n,height:s}=Q(this.props.scale);return a.a.createElement(G,{ref:this.canvasRef,imageData:this.imageData,width:n,height:s,onKeyDown:e,onKeyUp:t,onBlur:r},null)}}ee.propTypes={scale:p.a.number,display:p.a.object,onKeyDown:p.a.func,onKeyUp:p.a.func,onBlur:p.a.func},ee.defaultProps={scale:1};const te={unknown:-1,vertexShader:0,fragmentShader:1},re=!0;function ne(e,t,r){const n=function(e,t){switch(t){case te.vertexShader:return e.VERTEX_SHADER;case te.fragmentShader:return e.FRAGMENT_SHADER}return te.unknown}(e,t);n===te.unknown&&console.warn(`Unknown shader type: ${t}`);const a=e.createShader(n);if(0===a&&console.warn("Fail to create shader"),e.shaderSource(a,r),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS)){const t=e.getShaderInfoLog(a);return console.warn(`Fail to compile shader: ${t}`),e.deleteShader(a),null}return function(e,t,r,n,a,s){return{type:e,nativeTypy:t,nativeShader:r,source:n,isCompiled:a,isDeleted:s}}(t,n,a,r,!0,!1)}function ae(e,t){e.deleteShader(oe(t)),function(e,t){e.isDeleted=t}(t,!0)}function se(e){return e.type}function oe(e){return e.nativeShader}function ie(e){return e.nativeProgram}const ce=e=>e.shaderReducer,ue=e=>ce(e).vertSource,le=e=>ce(e).fragSource,pe=e=>ce(e).loading,de=e=>ce(e).loaded;function me(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ye extends a.a.Component{constructor(...e){super(...e),me(this,"canvasRef",a.a.createRef()),me(this,"gl",null),me(this,"program",null),me(this,"texture",null)}initGL(){const{vertShader:e,fragShader:t}=this.props,{gl:r}=this;r.viewport(0,0,this.props.width,this.props.height),r.clearColor(0,0,0,0);const n=ne(r,te.vertexShader,e),a=ne(r,te.fragmentShader,t),s=function(e,t,r){const n=e.createProgram();if(se(t)!==te.vertexShader&&console.warn("Invalid vertex shader type"),se(r)!==te.fragmentShader&&console.warn("Invalid fragment shader type"),e.attachShader(n,oe(t)),e.attachShader(n,oe(r)),e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){const t=e.getProgramInfoLog(n);return console.warn(`Fail to link program: ${t}`),e.deleteProgram(n),null}return{nativeProgram:n,isLinked:!0,isUsed:!1,isDeleted:!1}}(r,n,a);ae(r,n),ae(r,a);const o=r.getUniformLocation(s.nativeProgram,"s_texture");!function(e,t){e.useProgram(ie(t)),function(e,t){e.isUsed=t}(t,re)}(r,s);const i=r.createBuffer(),c=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,i),r.bufferData(r.ARRAY_BUFFER,fe,r.STATIC_DRAW),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,c),r.bufferData(r.ELEMENT_ARRAY_BUFFER,be,r.STATIC_DRAW),r.vertexAttribPointer(0,3,r.FLOAT,!1,5*Float32Array.BYTES_PER_ELEMENT,0),r.vertexAttribPointer(1,2,r.FLOAT,!1,5*Float32Array.BYTES_PER_ELEMENT,3*Float32Array.BYTES_PER_ELEMENT),r.enableVertexAttribArray(0),r.enableVertexAttribArray(1),r.pixelStorei(r.UNPACK_ALIGNMENT,1);const u=r.createTexture();r.bindTexture(r.TEXTURE_2D,u),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.activeTexture(r.TEXTURE0),r.uniform1i(o,0),this.texture=u,this.program=s}componentDidMount(){this.gl=this.getCanvasContext(),this.initGL(),this.setImageBinaries(this.props.displayBuffer)}componentWillReceiveProps(e){this.setImageBinaries(e.displayBuffer)}shouldComponentUpdate(e){return this.props.width!==e.width||this.props.height!==e.height}componentDidUpdate(e){const{width:t,height:r}=this.props;e.width===t&&e.height===r||(this.gl.viewport(0,0,t,r),this.setImageBinaries(this.props.displayBuffer))}getCanvasContext(){return this.canvasRef.current.getContext("webgl2")}setImageBinaries(e){const{gl:t}=this;t.clear(t.COLOR_BUFFER_BIT),t.texImage2D(t.TEXTURE_2D,0,t.R8,W,X,0,t.RED,t.UNSIGNED_BYTE,e),t.drawElements(t.TRIANGLES,be.length,t.UNSIGNED_SHORT,0)}render(){const{width:e,height:t,onKeyDown:r,onKeyUp:n,onBlur:s}=this.props;return a.a.createElement("canvas",{ref:this.canvasRef,tabIndex:0,width:e,height:t,onKeyDown:r,onKeyUp:n,onBlur:s},null)}}ye.propTypes={displayBuffer:p.a.object.isRequired,vertShader:p.a.string.isRequired,fragShader:p.a.string.isRequired,width:p.a.number,height:p.a.number,onKeyDown:p.a.func,onKeyUp:p.a.func,onBlur:p.a.func},ye.defaultProps={width:300,height:150};const fe=Float32Array.from([-1,1,0,0,0,1,1,0,1,0,-1,-1,0,0,1,1,1,0,1,0,1,-1,0,1,1,-1,-1,0,0,1]),be=Uint16Array.from([0,1,2,1,4,2]);var he=Object(u.b)(function(e){return{vertShader:ue(e),fragShader:le(e)}},null,null,{forwardRef:!0})(ye);class Ee extends a.a.Component{constructor(...e){var t,r,n;super(...e),t=this,r="canvasRef",n=a.a.createRef(),r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}shouldComponentUpdate(e){return this.props.scale!==e.scale}updateDisplayData(e){this.setImageBinaries(Z(e))}setImageBinaries(e){this.canvasRef.current.setImageBinaries(e)}render(){const{onKeyDown:e,onKeyUp:t,onBlur:r,display:n}=this.props,{width:s,height:o}=Q(this.props.scale);return a.a.createElement(he,{ref:this.canvasRef,displayBuffer:Z(n),width:s,height:o,onKeyDown:e,onKeyUp:t,onBlur:r},null)}}Ee.propTypes={scale:p.a.number,display:p.a.object,onKeyDown:p.a.func,onKeyUp:p.a.func,onBlur:p.a.func},Ee.defaultProps={scale:1};const ge=({number:e,value:t})=>a.a.createElement("p",null,`R${e.toString(16).toUpperCase()}: ${String(t).padStart(3,"0")}`);ge.propTypes={number:p.a.number.isRequired,value:p.a.number.isRequired};var _e=ge;const Re=({value:e})=>a.a.createElement("p",null,`I: ${e}`);Re.propTypes={value:p.a.number.isRequired};var Se=Re;const ve=({value:e})=>a.a.createElement("p",null,`DT: ${e}`);ve.propTypes={value:p.a.number.isRequired};var ke=ve;const Te=({value:e})=>a.a.createElement("span",null,`ST: ${String(e)}`);Te.propTypes={value:p.a.number.isRequired};var xe=Te;const we=({value:e})=>a.a.createElement("p",null,`PC: ${e}`);we.propTypes={value:p.a.number.isRequired};var De=we;const Oe=({stackPointer:e,stackValues:t})=>a.a.createElement(a.a.Fragment,null,a.a.createElement("span",null,"SP:"),a.a.createElement("span",null,String(e)),...t.slice(0,12).map((e,t)=>a.a.createElement("p",null,a.a.createElement("span",null,`${String(t)}: ${String(e)}`))));Oe.propTypes={stackPointer:p.a.number.isRequired,stackValues:p.a.arrayOf(p.a.number).isRequired};var Ne=Oe;const Pe=e=>e.chip8Reducer,Ce=e=>Pe(e).programCounter,Ie=e=>Pe(e).registerI,Ae=e=>Pe(e).soundTimer,Ue=e=>Pe(e).delayTimer,Le=e=>Pe(e).stackPointer,je=e=>Pe(e).stackValues,Be=e=>Pe(e).registers,Me=e=>Pe(e).keyPressCount;r(105);class $e extends a.a.Component{render(){const{registerI:e,delayTimer:t,soundTimer:r,programCounter:n,stackPointer:s,stackValues:o}=this.props,i=this.props.registers.map(Ke);return a.a.createElement("div",{className:"state-display"},a.a.createElement("div",{className:"state-display__registers",key:"registers"},i),a.a.createElement("div",{className:"state-display__chip-8-state",key:"chip-8-state"},a.a.createElement(Se,{value:e}),a.a.createElement(ke,{value:t}),a.a.createElement(xe,{value:r}),a.a.createElement(De,{value:n}),a.a.createElement(Ne,{stackPointer:s,stackValues:o})))}}const Ke=(e,t)=>a.a.createElement(_e,{value:e,number:t,key:t});$e.propTypes={registers:p.a.arrayOf(p.a.number).isRequired,registerI:p.a.number.isRequired,delayTimer:p.a.number.isRequired,soundTimer:p.a.number.isRequired,programCounter:p.a.number.isRequired,stackPointer:p.a.number.isRequired,stackValues:p.a.arrayOf(p.a.number).isRequired};var qe=Object(u.b)(e=>({registers:Be(e),registerI:Ie(e),delayTimer:Ue(e),soundTimer:Ae(e),programCounter:Ce(e),stackPointer:Le(e),stackValues:je(e)}))($e),Fe=r(12),Ge=r.n(Fe),We=r(76);const Xe=16,Ve=8,Ye=2,He=9,ze=2,Je=2,Qe=Uint8Array.from([110,5,101,0,107,6,106,0,163,12,218,177,122,4,58,64,18,8,123,2,59,18,18,6,108,32,109,31,163,16,220,209,34,246,96,0,97,0,163,18,208,17,112,8,163,14,208,17,96,64,240,21,240,7,48,0,18,52,198,15,103,30,104,1,105,255,163,14,214,113,163,16,220,209,96,4,224,161,124,254,96,6,224,161,124,2,96,63,140,2,220,209,163,14,214,113,134,132,135,148,96,63,134,2,97,31,135,18,71,31,18,172,70,0,104,1,70,63,104,255,71,0,105,1,214,113,63,1,18,170,71,31,18,170,96,5,128,117,63,0,18,170,96,1,240,24,128,96,97,252,128,18,163,12,208,113,96,254,137,3,34,246,117,1,34,246,69,96,18,222,18,70,105,255,128,96,128,197,63,1,18,202,97,2,128,21,63,1,18,224,128,21,63,1,18,238,128,21,63,1,18,232,96,32,240,24,163,14,126,255,128,224,128,4,97,0,208,17,62,0,18,48,18,222,120,255,72,254,104,255,18,238,120,1,72,2,104,1,96,4,240,24,105,255,18,112,163,20,245,51,242,101,241,41,99,55,100,0,211,69,115,5,242,41,211,69,0,238,224,0,128,0,252,0,170,0,0,0,0,0]),Ze=Uint8Array.from([0,224,99,0,100,1,101,238,53,238,19,16,99,0,100,2,101,238,102,238,85,96,19,16,99,0,100,3,101,238,69,253,19,16,99,0,100,4,101,238,117,1,53,239,19,16,99,0,100,5,111,1,101,238,102,239,133,101,63,0,19,16,99,0,100,6,111,0,101,239,102,238,133,101,63,1,19,16,111,0,99,0,100,7,101,238,102,239,133,103,63,1,19,16,99,0,100,8,111,1,101,239,102,238,133,103,63,0,19,16,99,0,100,9,101,240,102,15,133,97,53,255,19,16,99,1,100,0,101,240,102,15,133,98,53,0,19,16,99,1,100,1,101,240,102,15,133,99,53,255,19,16,111,0,99,1,100,2,101,129,133,14,63,1,19,16,99,1,100,3,111,1,101,71,133,14,63,0,19,16,99,1,100,4,111,0,101,1,133,6,63,1,19,16,99,1,100,5,111,1,101,2,133,6,63,0,19,16,99,1,100,6,96,21,97,120,163,208,241,85,241,101,48,21,19,16,49,120,19,16,99,1,100,7,96,138,163,208,240,51,163,208,240,101,48,1,19,16,96,1,240,30,240,101,48,3,19,16,96,1,240,30,240,101,48,8,19,16,19,50,19,14,163,42,96,19,97,9,208,24,243,41,96,34,97,11,208,21,244,41,96,40,97,11,208,21,19,14,255,240,240,255,240,240,240,255,163,88,96,21,97,11,99,8,208,24,112,8,243,30,48,45,19,58,163,112,96,2,97,24,99,8,208,24,112,5,243,30,48,62,19,76,19,14,240,136,136,240,136,136,136,240,120,132,132,132,132,132,132,120,132,196,164,148,140,132,132,132,192,160,160,192,160,160,192,0,0,0,160,160,224,32,32,224,0,0,0,0,0,0,0,0,192,160,160,192,160,160,192,0,0,0,96,160,192,128,96,0,0,0,96,128,64,32,192,0,128,128,192,128,128,128,96,0,224,128,128,128,128,128,224,0,0,0,64,160,160,160,64,0,32,32,32,96,160,160,96,0,0,0,96,160,192,128,96,0,0,0,0,96,64,64,80,0,0,0,0,0,0,0]);function et(e,t){return e.subarray(t,t+Je)}function tt(e,t){return e.find(e=>e.value===t)}const rt=e=>e.assemblyReducer,nt=e=>rt(e).assemblyLines,at=e=>rt(e).lineNumber,st=e=>nt(e)[at(e)].address,ot=Object(We.a)(nt,at,e=>rt(e).count,(e,t,r)=>{const n=function(e,t){return e<t?t:e}(0,t-(r/2|0));return e.slice(n,function(e,t){return e<t?e:t}(e.length,n+r))});r(107);const it=({currentAddress:e,assemblyLines:t})=>{const r=t.map(({address:t,opcode:r,assembly:n})=>a.a.createElement("div",{key:t,className:Ge()({"assembly__line--current":e===t})},a.a.createElement("span",null,t),a.a.createElement("span",{className:"assembly__opcode"},`: ${r} - `),a.a.createElement("span",null,n)));return a.a.createElement("div",{className:"assembly"},r)};it.propTypes={assemblyLines:p.a.arrayOf(p.a.object).isRequired,currentAddress:p.a.number.isRequired};var ct=Object(u.b)(e=>({assemblyLines:ot(e),currentAddress:st(e)}))(it);const ut=16,lt={1:1,2:2,3:3,4:12,q:4,w:5,e:6,r:13,a:7,s:8,d:9,f:14,z:10,x:0,c:11,v:15},pt=0,dt=1;function mt(){const e=new SharedArrayBuffer(ut);return{keyboard:new Uint8Array(e),keyboardMap:{...lt},keyboardKeys:Object.keys(lt)}}function yt(e,t){return e.keyboard[t]}function ft(e,t){return yt(e,t)===dt}function bt(e,t){return e.keyboardMap[t]}r(109);const ht=a.a.createElement("span",{className:"key__label"},"1"),Et=a.a.createElement("span",{className:"key__label"},"2"),gt=a.a.createElement("span",{className:"key__label"},"3"),_t=a.a.createElement("span",{className:"key__label"},"C"),Rt=a.a.createElement("span",{className:"key__label"},"4"),St=a.a.createElement("span",{className:"key__label"},"5"),vt=a.a.createElement("span",{className:"key__label"},"6"),kt=a.a.createElement("span",{className:"key__label"},"D"),Tt=a.a.createElement("span",{className:"key__label"},"7"),xt=a.a.createElement("span",{className:"key__label"},"8"),wt=a.a.createElement("span",{className:"key__label"},"9"),Dt=a.a.createElement("span",{className:"key__label"},"E"),Ot=a.a.createElement("span",{className:"key__label"},"A"),Nt=a.a.createElement("span",{className:"key__label"},"0"),Pt=a.a.createElement("span",{className:"key__label"},"B"),Ct=a.a.createElement("span",{className:"key__label"},"F"),It=({keyboard:e})=>{const t=Ge()("keyboard__key",{"keyboard__key--press":ft(e,1)}),r=Ge()("keyboard__key",{"keyboard__key--press":ft(e,2)}),n=Ge()("keyboard__key",{"keyboard__key--press":ft(e,3)}),s=Ge()("keyboard__key",{"keyboard__key--press":ft(e,12)}),o=Ge()("keyboard__key",{"keyboard__key--press":ft(e,4)}),i=Ge()("keyboard__key",{"keyboard__key--press":ft(e,5)}),c=Ge()("keyboard__key",{"keyboard__key--press":ft(e,6)}),u=Ge()("keyboard__key",{"keyboard__key--press":ft(e,13)}),l=Ge()("keyboard__key",{"keyboard__key--press":ft(e,7)}),p=Ge()("keyboard__key",{"keyboard__key--press":ft(e,8)}),d=Ge()("keyboard__key",{"keyboard__key--press":ft(e,9)}),m=Ge()("keyboard__key",{"keyboard__key--press":ft(e,14)}),y=Ge()("keyboard__key",{"keyboard__key--press":ft(e,10)}),f=Ge()("keyboard__key",{"keyboard__key--press":ft(e,0)}),b=Ge()("keyboard__key",{"keyboard__key--press":ft(e,11)}),h=Ge()("keyboard__key",{"keyboard__key--press":ft(e,15)});return a.a.createElement("div",{className:"keyboard"},a.a.createElement("ul",{className:"keyboard__row"},a.a.createElement("li",{className:t},ht),a.a.createElement("li",{className:r},Et),a.a.createElement("li",{className:n},gt),a.a.createElement("li",{className:s},_t)),a.a.createElement("ul",{className:"keyboard__row"},a.a.createElement("li",{className:o},Rt),a.a.createElement("li",{className:i},St),a.a.createElement("li",{className:c},vt),a.a.createElement("li",{className:u},kt)),a.a.createElement("ul",{className:"keyboard__row"},a.a.createElement("li",{className:l},Tt),a.a.createElement("li",{className:p},xt),a.a.createElement("li",{className:d},wt),a.a.createElement("li",{className:m},Dt)),a.a.createElement("ul",{className:"keyboard__row"},a.a.createElement("li",{className:y},Ot),a.a.createElement("li",{className:f},Nt),a.a.createElement("li",{className:b},Pt),a.a.createElement("li",{className:h},Ct)))};It.propTypes={keyboard:p.a.object.isRequired,keyPressCount:p.a.number.isRequired};var At=Object(u.b)(function(e){return{keyPressCount:Me(e)}})(It);const Ut=0,Lt=512,jt=4096;function Bt(e){return e.programCounter[0]}function Mt(e,t){return e.programCounter[0]=t}function $t(e){return e.I[0]}const Kt=1,qt=0;function Ft(e){return{uint8:new Uint8Array(e),uint16:new Uint16Array([e[qt]<<8|e[Kt]])}}function Gt(e){return e.uint16[0]}function Wt(e){return function(e){return Ht(e)>>>4}(e)}function Xt(e){return function(e){return 15&Yt(e)}(e)}function Vt(e){return 4095&Gt(e)}function Yt(e){return e.uint8[Kt]}function Ht(e){return e.uint8[qt]}function zt(e){return function(e){return 15&Ht(e)}(e)}function Jt(e){return function(e){return Yt(e)>>>4}(e)}function Qt(e){return Yt(e)}const Zt=32;function er(){const e=new SharedArrayBuffer(Zt);return{stack:new Uint16Array(e),stackPointer:-1}}function tr(){const e=new SharedArrayBuffer(jt);return{bytes:new Uint8Array(e)}}function rr(e,t){ar(e,Ut,t)}function nr(e,t){return e.bytes[t]}function ar(e,t,r){for(let n=0;n<e.bytes.length&&n<r.length;n++)e.bytes[t+n]=r[n]}function sr(e,t){return Mt(e,t)}const or=128,ir=or+1;function cr(e){return nr(e,or)}function ur(e){return nr(e,ir)}function lr(e){const t={registers:new Uint8Array(e).subarray(0,Xe),programCounter:new Uint16Array(e).subarray(Ve,He),I:new Uint16Array(e).subarray(He)};return sr(t,Lt),t}function pr(e,t){!function(e,t){ar(e,Lt,t)}(e.memory,t)}function dr(e){return e.display}function mr(e){return e.processor}function yr(e){return e.memory}function fr(e){return e.stack}function br(e){return e.keyboard}function hr(e){return function(e){const t=new Array(e.registers.length);let r=e.registers.length;for(;r--;)t[r]=e.registers[r];return t}(mr(e))}function Er(e){return Bt(mr(e))}function gr(e){return function(e){const t=new Array(e.stack.length);let r=e.stack.length;for(;r--;)t[r]=e.stack[r];return t}(fr(e))}function _r(e,t){return function(e,t){const{keyboardKeys:r}=e;for(let e=0;e<r.length;e++)if(r[e]===t)return!0;return!1}(e.keyboard,t)}function Rr(e,t){return function(e,t){return e.keyboard[bt(e,t)]=dt}(e.keyboard,t)}function Sr(e,t){return function(e,t){return e.keyboard[bt(e,t)]=pt}(e.keyboard,t)}function vr(e){switch(Wt(e)){case 0:switch(Yt(e)){case 224:return"CLS";case 238:return"RET"}break;case 1:return`JP ${Vt(e)}`;case 2:return`CALL ${Vt(e)}`;case 3:return`SE R${zt(e)}, ${Qt(e)}`;case 4:return`SNE R${zt(e)}, ${Qt(e)}`;case 5:return`SE R${zt(e)}, R${Jt(e)}`;case 6:return`LD R${zt(e)}, ${Qt(e)}`;case 7:return`ADD R${zt(e)}, ${Qt(e)}`;case 8:switch(Xt(e)){case 0:return`LD R${zt(e)}, R${Jt(e)}`;case 1:return`OR R${zt(e)}, R${Jt(e)}`;case 2:return`AND R${zt(e)}, R${Jt(e)}`;case 3:return`XOR R${zt(e)}, R${Jt(e)}`;case 4:return`ADD R${zt(e)}, R${Jt(e)}`;case 5:return`SUB R${zt(e)}, R${Jt(e)}`;case 6:return`SHR R${zt(e)}, R${Jt(e)}`;case 7:return`SUBN R${zt(e)}, R${Jt(e)}`;case 14:return`SHL R${zt(e)}, R${Jt(e)}`}break;case 9:return`SNE R${zt(e)}, R${Jt(e)}`;case 10:return`LD I, ${Vt(e)}`;case 11:return`JP R0, ${Vt(e)}`;case 12:return`RND RX, ${Qt(e)}`;case 13:return`DRW R${zt(e)}, R${Jt(e)}, ${Xt(e)}`;case 14:switch(Qt(e)){case 158:return`SKP R${zt(e)}`;case 161:return`SKNP R${zt(e)}`}break;case 15:switch(Qt(e)){case 7:return`LD R${zt(e)}, DT`;case 10:return`LD R${zt(e)}, K`;case 21:return`LD DT, R${zt(e)}`;case 24:return`LD ST, R${zt(e)}`;case 30:return`ADD I, R${zt(e)}`;case 41:return`LD F, R${zt(e)}`;case 51:return`BCD R${zt(e)}`;case 85:return`LD [I], R${zt(e)}`;case 101:return`LD R${zt(e)}, [I]`}break}return"UNKNOWN OPCODE"}const kr="[Assembly] SET_ASSEMBLY_LINES",Tr="[Assembly] SET_ASSEMBLY_LINE_NUMBER";function xr(e){return function(t){const r=new Array(e.length);for(let t=0;t<r.length;t++){const a=Ft(et(e,t));r[t]={address:(n=t,n+Lt),opcode:Gt(a).toString(16).toUpperCase().padStart(4,"0"),assembly:vr(a)}}var n;return t(function(e){return{type:kr,payload:{lines:e}}}(r)),r}}const wr="[Chip-8] SET_PROGRAM_COUNTER",Dr="[Chip-8] SET_REGISTER_I",Or="[Chip-8] SET_SOUND_TIMER",Nr="[Chip-8] SET_DELAY_TIMER",Pr="[Chip-8] SET_STACK_POINTER",Cr="[Chip-8] SET_STACK_VALUES",Ir="[Chip-8] SET_REGISTERS",Ar="[Chip-8] INCREMENT_KEY_PRESS_COUNT",Ur="[Chip-8] DECREMENT_KEY_PRESS_COUNT",Lr="[Chip-8] RESET_KEY_PRESS_COUNT";const jr=e=>e.settingsReducer,Br=e=>jr(e).resolution.value,Mr=e=>jr(e).speedMode.value,$r=e=>jr(e).rendererMode.value,Kr=e=>jr(e).showDebbugInfo,qr=e=>jr(e).isRunning,Fr={DEFAULT_SPEED_MODE:1e3/60,DOUBLE_SPEED_MODE:1e3/120,TRIPLE_SPEED_MODE:1e3/180,QUADRUPLE_SPEED_MODE:1e3/240},Gr=[{value:Fr.DEFAULT_SPEED_MODE,label:"1X (Default mode)"},{value:Fr.DOUBLE_SPEED_MODE,label:"2X"},{value:Fr.TRIPLE_SPEED_MODE,label:"3X"},{value:Fr.QUADRUPLE_SPEED_MODE,label:"4X"}],Wr=[{value:1,label:"64x32 (Original)"},{value:5,label:"320x160"},{value:10,label:"640x320"},{value:15,label:"960x480"},{value:20,label:"1280x640"},{value:25,label:"1600x800"},{value:30,label:"1920x960"},{value:40,label:"2560x1280"},{value:45,label:"2880x1440"},{value:50,label:"3200x1600"},{value:55,label:"3520x1760"},{value:60,label:"3840x1920"}],Xr={canvas:0,webGL:1},Vr=[{value:Xr.canvas,label:"Canvas"},{value:Xr.webGL,label:"WebGL"}];r(111);function Yr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Hr extends a.a.Component{constructor(e){super(e),Yr(this,"displayRef",a.a.createRef()),Yr(this,"executeNextCycly",this.props.showDebbugInfo?this.executeNextCyclyWithUpdateState:this.executeNextCyclyWithoutUpdateState),Yr(this,"subcription",null),Yr(this,"onKeyDown",e=>{if(!e.repeat){const t=e.key.toLowerCase(),{chip8:r}=this.props;_r(r,t)&&(Rr(r,t),this.props.incrementKeyPressCount())}}),Yr(this,"onKeyUp",e=>{const t=e.key.toLowerCase(),{chip8:r}=this.props;_r(r,t)&&(Sr(r,t),this.props.decrementKeyPressCount())}),Yr(this,"onBlur",()=>{this.props.resetKeyPressCount()}),Yr(this,"onStateKeyPress",e=>{switch(e.charCode){case 56:{const{isRunning:e}=this.props;this.subcription=this.props.switchLoopState(!e).subscribe(()=>this.setState({onStateKeyPress:this.onStateKeyPress})),this.setState({onStateKeyPress:void 0});break}case 57:{const{isRunning:e}=this.props;e||(this.subcription=this.props.executeNextInstruction().subscribe(()=>{this.setState({onStateKeyPress:this.onStateKeyPress}),this.executeNextCycly()}),this.setState({onStateKeyPress:void 0}));break}}}),this.state={onStateKeyPress:this.onStateKeyPress,Display:this.getRendererDisplay(e.rendererMode)}}componentDidUpdate(e){const{showDebbugInfo:t,rendererMode:r}=this.props;e.showDebbugInfo!==t&&(this.updateState(),this.executeNextCycly=t?this.executeNextCyclyWithUpdateState:this.executeNextCyclyWithoutUpdateState),r!==e.rendererMode&&this.setState({Display:this.getRendererDisplay(r)})}getRendererDisplay(e){switch(e){case Xr.canvas:return ee;case Xr.webGL:return Ee}return null}componentWillUnmount(){this.subcription&&this.subcription.unsubscribe()}executeNextCyclyWithUpdateState(){this.updateDisplay(),this.updateState()}executeNextCyclyWithoutUpdateState(){this.updateDisplay()}updateDisplay(){this.displayRef.current.updateDisplayData(dr(this.props.chip8))}updateState(){const{chip8:e}=this.props;this.props.setAssemblyLineNumber(Er(e)),this.props.setProgramCounter(Er(e)),this.props.setRegisterI(function(e){return $t(mr(e))}(e)),this.props.setDelayTimer(function(e){return cr(yr(e))}(e)),this.props.setSoundTimer(function(e){return ur(yr(e))}(e)),this.props.setStackPointer(function(e){return fr(e).stackPointer}(e)),this.props.setStackValues(gr(e)),this.props.setRegisters(hr(e))}render(){const{Display:e}=this.state,{chip8:t,scale:r,showDebbugInfo:n}=this.props,s=n?a.a.createElement("div",{tabIndex:0,className:"debug-info__state-display",onKeyPress:this.state.onStateKeyPress},a.a.createElement("div",{className:"state-display__display"},a.a.createElement(qe)),a.a.createElement(ct)):null;return a.a.createElement("div",{className:"chip-8"},a.a.createElement("div",{className:"chip-8__display"},a.a.createElement(e,{ref:this.displayRef,display:dr(t),scale:r,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,onBlur:this.onBlur})),a.a.createElement("div",{className:"chip-8__debug-info"},s,a.a.createElement("div",{className:"display-row__keyboard-wrapper"},a.a.createElement(At,{keyboard:br(t)}))))}}Hr.propTypes={chip8:p.a.object.isRequired,rendererMode:p.a.number.isRequired,switchLoopState:p.a.func.isRequired,executeNextInstruction:p.a.func.isRequired,showDebbugInfo:p.a.bool,scale:p.a.number};const zr={setAssemblyLineNumber:function(e){return{type:Tr,payload:{lineNumber:(t=e,t-Lt)}};var t},setProgramCounter:function(e){return{type:wr,payload:{pc:e}}},setRegisterI:function(e){return{type:Dr,payload:{registerI:e}}},setSoundTimer:function(e){return{type:Or,payload:{soundTimer:e}}},setDelayTimer:function(e){return{type:Nr,payload:{delayTimer:e}}},setStackPointer:function(e){return{type:Pr,payload:{stackPointer:e}}},setStackValues:function(e){return{type:Cr,payload:{stackValues:e}}},setRegisters:function(e){return{type:Ir,payload:{registers:e}}},incrementKeyPressCount:function(){return{type:Ar}},decrementKeyPressCount:function(){return{type:Ur}},resetKeyPressCount:function(){return{type:Lr}}};var Jr=Object(u.b)(e=>({rendererMode:$r(e),showDebbugInfo:Kr(e),isRunning:qr(e)}),zr,null,{forwardRef:!0})(Hr),Qr=r(169),Zr=r(158),en=r(171),tn=r(165),rn=r(159),nn=r(160),an=r(167),sn=r(164);const on=0,cn=1,un=127;function ln(e,t){return e.postMessage(t),new Promise((r,n)=>{const a=s=>{const{data:{eventType:o,payload:i,error:c}}=s;t.eventType===o&&(e.removeEventListener("message",a),c?n(i):r(i))};e.addEventListener("message",a)})}const pn={INIT:0,RUN_LOOP:1,SET_LOOP_MODE:2,EXECUTE_NEXT_INSTRUCTION:3,STOP_LOOP:4};function dn(e,t=!1){return{eventType:pn.SET_LOOP_MODE,payload:{mode:e},error:t}}const mn="[Settings] SET_IS_RUNNING",yn="[Settings] SET_SPEED_MODE",fn="[Settings] SET_RESOLUTION_MODE",bn="[Settings] SET_RENDERER_MODE",hn="[Settings] SET_SHOW_DEBBUG_INFO";function En(e){return{type:mn,payload:{isRunning:e}}}function gn(e){return{type:yn,payload:{speedMode:e}}}function _n(e){return{type:fn,payload:{resolution:e}}}function Rn(e){return async function(t){return await ln(e,function(e=!1){return{eventType:pn.RUN_LOOP,payload:null,error:e}}()),t(En(!0)),!0}}function Sn(e){return async function(t){return await ln(e,function(e=!1){return{eventType:pn.STOP_LOOP,payload:null,error:e}}()),t(En(!1)),!1}}r(113);const vn=Object(sn.a)({root:{marginBottom:"8px"}}),kn=e=>{const{open:t,goToGameListState:r,onCloseModal:n}=e,s=Object(u.d)(Mr),o=Object(u.d)(Br),i=Object(u.d)($r),c=Object(u.d)(Kr),l=vn(),p=Object(u.c)();return a.a.createElement(Qr.a,{fullWidth:!0,open:t,onClose:n},a.a.createElement("div",{className:"menu-settings"},a.a.createElement(Zr.a,{fullWidth:!0,className:l.root},a.a.createElement(en.a,{htmlFor:"renderer"},"Renderer"),a.a.createElement(tn.a,{inputProps:{name:"renderer",id:"renderer"},value:i,onChange:function(e){p(function(e){return{type:bn,payload:{renderer:e}}}(tt(Vr,e.target.value)))}},Vr.map(({value:e,label:t},r)=>a.a.createElement(rn.a,{key:r,value:e},t)))),a.a.createElement(Zr.a,{fullWidth:!0,className:l.root},a.a.createElement(en.a,{htmlFor:"resolution"},"Resolution"),a.a.createElement(tn.a,{inputProps:{name:"resolution",id:"resolution"},value:o,onChange:function(e){p(_n(tt(Wr,e.target.value)))}},Wr.map(({value:e,label:t},r)=>a.a.createElement(rn.a,{key:r,value:e},t)))),a.a.createElement(Zr.a,{fullWidth:!0,className:l.root},a.a.createElement(en.a,{htmlFor:"speed-mode"},"Speed Mode"),a.a.createElement(tn.a,{inputProps:{name:"speed-mode",id:"speed-mode"},value:s,onChange:function(e){p(gn(tt(Gr,e.target.value)))}},Gr.map(({value:e,label:t},r)=>a.a.createElement(rn.a,{key:r,value:e},t)))),a.a.createElement(nn.a,{className:l.root,control:a.a.createElement(an.a,{checked:c,onChange:function(){p({type:hn,payload:{show:!c}})},value:"show-debbug-info",color:"primary"}),label:"Show debbug info"}),a.a.createElement(m.a,{fullWidth:!0,className:l.root,variant:"contained",color:"primary",onClick:n},"Close"),a.a.createElement(m.a,{fullWidth:!0,variant:"contained",color:"primary",onClick:r},"Go to games list")))};kn.propTypes={open:p.a.bool.isRequired,goToGameListState:p.a.func.isRequired,onCloseModal:p.a.func.isRequired};var Tn=kn,xn=r(77),wn=r(168),Dn=r(161);const On="[Thread] SET_CPU_THREAD_BLOB_URL",Nn="[Thread] SET_CPU_THREAD_LOADING",Pn="[Thread] SET_CPU_THREAD_LOADED";function Cn(e){return async function(t){t({type:Nn});const r=await(await fetch(e)).blob(),n=URL.createObjectURL(r);return t(function(e){return{type:On,payload:{url:e}}}(n)),t({type:Pn}),n}}const In="[Shader] SET_LOADING_SHADER",An="[Shader] SET_LOADED_SHADER",Un="[Shader] SET_SHADERS";function Ln(e,t){return async function(r){r({type:In});const n=await Promise.all([fetch(e),fetch(t)]),a=await Promise.all(n.map(e=>e.text()));var s,o;return r((s=a[0],o=a[1],{type:Un,payload:{vert:s,frag:o}})),r({type:An}),a}}const jn=e=>e.threadReducer,Bn=e=>jn(e).cpuThread.url,Mn=e=>jn(e).cpuThread.loading,$n=e=>jn(e).cpuThread.loaded;function Kn(e,t,r,n){return Object(xn.a)(ln(t,function(e,t=!1){return{eventType:pn.INIT,payload:{chip8:e},error:t}}(r))).pipe(Object(wn.a)(()=>Object(xn.a)(e(function(e,t){return async function(r){const[n]=await Promise.all([(async()=>tt(Gr,t))(),ln(e,dn(t))]);return r(gn(n)),t}}(t,n)))),Object(wn.a)(()=>Object(xn.a)(e(Rn(t)))))}function qn(e,t){return Object(xn.a)(e(Rn(t)))}function Fn(e,t,r){const n=(a=un,{buffer:new Int32Array(t),index:a});var a;!function t(){const a=requestAnimationFrame(t);!function(e){Atomics.compareExchange(e.buffer,e.index,on,cn)}(n),function(e){e.current.executeNextCycly()}(r),function(e){Atomics.compareExchange(e.buffer,e.index,cn,on)===cn&&Atomics.notify(e.buffer,e.index,1)}(n),e.terminate=()=>cancelAnimationFrame(a)}()}function Gn(e){return Object(xn.a)(ln(e,function(e=!1){return{eventType:pn.EXECUTE_NEXT_INSTRUCTION,payload:null,error:e}}()))}r(115);const Wn=({goToGameListState:e})=>{const t=function(){const e=Object(u.d)(w),t=Object(u.d)(x);return e<t.length?t[e].rom:null}(),r=Object(n.useRef)(null),s=Object(n.useRef)(function(e){const t={processor:lr(new SharedArrayBuffer(Xe+Ye+ze)),stack:er(),memory:tr(),display:H(),keyboard:mt()};return rr(t.memory,V),e&&pr(t,e),t}(t)),o=Object(n.useRef)({terminate:()=>{}}),[i,c]=function(e,t,r){const[a,s]=Object(n.useState)(e);return Object(n.useEffect)(()=>{const e=Object(D.a)(window,"keypress").pipe(Object(Dn.a)(e=>"Backslash"===e.code),Object(wn.a)(()=>t(a))).subscribe(()=>{s(!a)});return()=>e.unsubscribe()},[a,r]),[a,function(){s(!1)}]}(!1,b,r.current),l=Object(u.d)(Bn),p=Object(u.d)(Mr),d=Object(u.d)(Br),m=function(){const e=Object(u.d)(de),t=Object(u.d)(pe),r=Object(u.d)($n),a=Object(u.d)(Mn),s=Object(u.c)();return Object(n.useEffect)(()=>{e||t||s(Ln("./assets/shaders/main.vert","./assets/shaders/main.frag")),r||a||s(Cn("./cpu-thread.js"))},[]),e&&!t&&r&&!a}(),y=Object(n.useRef)(),f=Object(u.c)();function b(e){return e?qn(f,r.current).pipe(Object(q.a)(h)):function(e,t){return Object(xn.a)(e(Sn(t)))}(f,r.current).pipe(Object(q.a)(E))}function h(){return Fn(o.current,(e=yr(s.current),e.bytes).buffer,y);var e}function E(){o.current.terminate()}return Object(n.useEffect)(()=>{f(_n(tt(Wr,10))),f(xr(t))},[]),Object(n.useEffect)(()=>{if(l){r.current=new Worker(l);const e=Kn(f,r.current,s.current,p).subscribe(h);return()=>{r.current.terminate(),e.unsubscribe(),o.current.terminate()}}},[l]),Object(n.useEffect)(()=>{if(r.current){const e=function(e,t){return Object(xn.a)(ln(e,dn(t)))}(r.current,p).subscribe();return()=>e.unsubscribe()}},[p]),m?a.a.createElement("div",null,a.a.createElement(Jr,{ref:y,chip8:s.current,scale:d,switchLoopState:b,executeNextInstruction:function(){return Gn(r.current)}}),a.a.createElement(Tn,{open:i,goToGameListState:e,onCloseModal:function(){qn(f,r.current).subscribe(()=>{h(),c()})}})):a.a.createElement("div",{className:"game__loader"},a.a.createElement(K.a,null))};Wn.propTypes={goToGameListState:p.a.func.isRequired};var Xn=Wn;const Vn={gamesList:0,game:1};var Yn=()=>{const[e,t]=Object(n.useState)(Vn.gamesList);switch(e){case Vn.gamesList:return a.a.createElement($,{goToGameState:function(){t(Vn.game)}});case Vn.game:return a.a.createElement(Xn,{goToGameListState:function(){t(Vn.gamesList)}})}return null};const Hn={assemblyLines:[],lineNumber:0,count:15};const zn={registers:[],registerI:0,delayTimer:0,soundTimer:0,programCounter:0,stackPointer:0,stackValues:[],keyPressCount:0};const Jn={loaded:!1,loading:!1,vertSource:"",fragSource:""};const Qn={isRunning:!1,showDebbugInfo:!0,resolution:Wr[2],speedMode:Gr[0],rendererMode:Vr[1]};const Zn={cpuThread:{loaded:!1,loading:!1,url:null}};const ea={selectedRomIndex:-1,roms:[{name:"TEST",rom:Ze},{name:"BRIX",rom:Qe}]};var ta=Object(c.c)({assemblyReducer:function(e=Hn,t){switch(t.type){case kr:return{...e,assemblyLines:[...t.payload.lines]};case Tr:return{...e,lineNumber:t.payload.lineNumber}}return e},chip8Reducer:function(e=zn,t){switch(t.type){case wr:return{...e,programCounter:t.payload.pc};case Dr:return{...e,registerI:t.payload.registerI};case Or:return{...e,soundTimer:t.payload.soundTimer};case Nr:return{...e,delayTimer:t.payload.delayTimer};case Pr:return{...e,stackPointer:t.payload.stackPointer};case Cr:return{...e,stackValues:t.payload.stackValues};case Ir:return{...e,registers:t.payload.registers};case Ar:return{...e,keyPressCount:e.keyPressCount+1};case Ur:return{...e,keyPressCount:e.keyPressCount-1};case Lr:return{...e,keyPressCount:0}}return e},shaderReducer:function(e=Jn,t){switch(t.type){case In:return{...e,loading:!0,loaded:!1};case An:return{...e,loading:!1,loaded:!0};case Un:return{...e,vertSource:t.payload.vert,fragSource:t.payload.frag}}return e},settingsReducer:function(e=Qn,t){switch(t.type){case mn:return{...e,isRunning:t.payload.isRunning};case yn:return{...e,speedMode:t.payload.speedMode};case fn:return{...e,resolution:t.payload.resolution};case bn:return{...e,rendererMode:t.payload.renderer};case hn:return{...e,showDebbugInfo:t.payload.show}}return e},threadReducer:function(e=Zn,t){switch(t.type){case On:return{...e,cpuThread:{...e.cpuThread,url:t.payload.url}};case Nn:return{...e,cpuThread:{...e.cpuThread,loading:!0,loaded:!1}};case Pn:return{...e,cpuThread:{...e.cpuThread,loading:!1,loaded:!0}}}return e},romsReducer:function(e=ea,t){switch(t.type){case v:return{...e,roms:e.roms.concat({name:t.payload.name,rom:t.payload.rom})};case k:return{...e,selectedRomIndex:t.payload.index}}return e}});const ra=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||c.d,na=Object(c.e)(ta,ra(Object(c.a)(i.a)));o.a.render(a.a.createElement(u.a,{store:na},a.a.createElement(Yn,null,null)),document.getElementById("app"))}});